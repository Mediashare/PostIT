{% extends 'view/form.html.twig' %}

{% block title %}Input{% endblock %}


{% block stylesheets %}
    {# Dependencies #}
    <link rel="stylesheet" href="{{ preload(asset('codemirror/lib/codemirror.css'), { as: 'style' }) }}">
    {# AutoCompletion #}
    <link rel="stylesheet" href="{{ preload(asset('codemirror/addon/hint/show-hint.css'), { as: 'style' }) }}">
{% endblock %}

{% block form_header %}
    <div class="col-lg-9 p-0">
        <input type="hidden" name="id" value="{{ input.id }}">
        <input type="text" name="type" class="w-100 rounded form-control" placeholder="Type..." required="true" {% if input.type %}value="{{ input.type }}"{% endif %} autofocus>
    </div>
    <div class="col-lg-3 p-0 d-flex">
        <div class="w-100 border-top">
            <a tabindex="-1" class="btn btn-cancel" title="Cancel" href="{{ path('admin') }}">
                <i class="fa fa-times"></i>
            </a>
        </div>
        <div class="w-100 border-top">
            <button tabindex="-1" type="submit" class="btn btn-submit" title="Submit">
                <i class="fa fa-check"></i>
            </button>
        </div>
    </div>
{% endblock %}

{% block editor %}
    <div class="col-lg-6 p-0">
        <div id="textarea_{{ input.id }}" class="shadow-lg rounded"></div>
        <textarea name="render_{{ input.id }}" id="input_{{ input.id }}" class="d-none" required></textarea>
    </div>
    <div class="col-lg-6 p-0">
        <div id="preview_{{ input.id }}" class="pt-0 markdown-body shadow-lg rounded">
            <div class="render_{{ input.id }}"></div>
        </div>
    </div>
{% endblock %}


{% block javascripts %}
    {# CodeMirror #}
    <script src="{{ preload(asset('codemirror/lib/codemirror.js'), { as: 'script', importance: 'high' }) }}"></script>
    <script src="{{ preload(asset('js/codemirror.js'), { as: 'script', importance: 'high' }) }}"></script>
    {# Mode #}
    <script src="{{ preload(asset('codemirror/mode/twig/twig.js'), { as: 'script' }) }}"></script>
    {# AutoCompletion #}
    <script src="{{ preload(asset('codemirror/addon/hint/anyword-hint.js'), { as: 'script' }) }}"></script>
    <script src="{{ preload(asset('codemirror/addon/hint/css-hint.js'), { as: 'script' }) }}"></script>
    <script src="{{ preload(asset('codemirror/addon/hint/html-hint.js'), { as: 'script' }) }}"></script>
    <script src="{{ preload(asset('codemirror/addon/hint/javascript-hint.js'), { as: 'script' }) }}"></script>
    <script src="{{ preload(asset('codemirror/addon/hint/show-hint.js'), { as: 'script' }) }}"></script>
    <script src="{{ preload(asset('codemirror/addon/hint/sql-hint.js'), { as: 'script' }) }}"></script>
    <script src="{{ preload(asset('codemirror/addon/hint/xml-hint.js'), { as: 'script' }) }}"></script>
    <script src="{{ preload(asset('codemirror/keymap/sublime.js'), { as: 'script' }) }}"></script>
    <script>
        {% if input.render %} {% set content = input.render %}
        {% else %} 
            {% set content = "<div class=\"col-12\"></div>" %} 
        {% endif %}
        CodeMirorInit(selector = "{{ input.id }}", 
            content = "{{- content|e('js') -}}", 
            mode = "twig", 
            path_render = '{{ path("input_show") }}', 
        );
    </script>
{% endblock %}